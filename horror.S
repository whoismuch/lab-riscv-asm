.data
N:
.word 4
M:
.word 3
matrix:
.word 4, 3, 2, 1
.word 2, 9, 4, 22
.word 6, 7, 5, 7
result:
.word 0	#M
.word 0	#N

.text

main:
addi s0, x0, 0 #счетчик для индекса по M
addi s1, x0, 0 #счетчик для индекса по N
la s2, matrix  #адрес текущего элемента
lw s3, 0(s2)   #значение текущего максимума 
la s4, result  #адрес результативного индекса M
addi s5, s4, 4 #адрес результативного индекса N
la s8, M	   #адрес значения M
la s9, N	   #адрес значения N
lw s6, 0(s8)    #значение M
lw s7, 0(s9)    #значение N

cycle:
addi sp, sp, -24  #Далее пихаем первые 6 значений в стек (см. выше какие значения)
sw s0, 20(sp)
sw s1, 16(sp)
sw s2, 12(sp)
sw s3, 8(sp)
sw s4, 4(sp)
sw s5, 0(sp)
call process      #Вызываем процедуру process
lw s3, 0(sp)	  #Перезаписываем текущий максимум (процедура его вернула)
addi sp, sp, 4    #Возвращаем sp в первоначальное состояние 
addi s1, s1, 1    #Инкреминируем cчетчик для индекса по N
addi s2, s2, 4	  #Берем адрес следующего элемента массива
blt s1, s7, cycle #Если счетчик для индекса по N < значения N -> обход строки не завершен, повторяем предыдущие действия
addi s1, x0, 0	  #Обнуляем N, ибо переходим к новой строчке
addi s0, s0, 1    #Инкреминируем счетчик для индекса по M
blt s0, s6, cycle #Если счетчик для индекса по M < значения M -> мы обошли не все столбцы, повторяем предыдущие действия


exit: 			  #Программа завершена, выходим
addi a0, x0, 10
ecall

process:
							#Выгружаем 6 значений из стека. t0~s0 (и т д)
lw t5, 0(sp)    
lw t4, 4(sp)
lw t3, 8(sp)
lw t2, 12(sp)
lw t1, 16(sp)
lw t0, 20(sp)
addi sp, sp, 20	 			#Значение sp увеличиваем на 20, так как дальше будем возвращать максимум через стек (24-4=20)
lw t6, 0(t2)				#Значение текущего элемента
sw t3, 0(sp)				#Записываем в стек значение текущего максимума
bge t3, t6, end				#Если значение текущего максимума >= значения текущего элемента -> выходим из процедуры 
							#Иначе перезапишем старый максимум на новый (текущий элемент)
sw t6, 0(sp)    			#Перезаписываем в стеке значение текущего элемента (нового максимума)
sw t0, 0(t4)				#Меняем значение M в результате на индекс текущего элемента по M
sw t1, 0(t5)    			#Меняем значение N в результате на индекс текущего элемента по N

end:
ret



